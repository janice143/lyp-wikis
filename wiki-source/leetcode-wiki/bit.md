---
outline: deep
---
# 位运算

### 1. **n & (n-1) 的运用**

**`n & (n-1)` 这个操作是算法中常见的，作用是消除数字 `n` 的二进制表示中的最后一个 1**。

### 2. **a ^ a = 0 的运用**

一个数和它本身做异或运算结果为 0，即 `a ^ a = 0`；一个数和 0 做异或运算的结果为它本身，即 `a ^ 0 = a`。

### 1 << bitPos

把1左移`bitPos`位，例如

```jsx
1 << 0 = 1
1 << 1 = 10
1 << 2 = 100
1 << 3 = 1000
```

### **位运算的常见操作**

位运算是通过操作数据的二进制位（bit）来完成的，常见的操作包括 **与**、**或**、**异或**、**取反**、**左移** 和 **右移**。

---

#### **1. 常见操作及其功能**

| 操作符 | 名称 | 说明 | 示例（假设 `a = 5 (0101)` 和 `b = 3 (0011)`） |
| --- | --- | --- | --- |
| `&` | **按位与** | 如果两个二进制位都为 `1`，结果为 `1`，否则为 `0` | `a & b = 1 (0001)` |
| ` | ` | **按位或** | 如果两个二进制位至少有一个为 `1`，结果为 `1` |
| `^` | **按位异或** | 如果两个二进制位不同，结果为 `1`，相同则为 `0` | `a ^ b = 6 (0110)` |
| `~` | **按位取反** | 对每个二进制位取反，即 `1` 变 `0`，`0` 变 `1` | `~a = -6 (取反后是 11111010)` |
| `<<` | **左移** | 将二进制位向左移动若干位，右侧补 `0`，相当于乘以 `2^n` | `a << 1 = 10 (1010)` |
| `>>` | **右移** | 将二进制位向右移动若干位，左侧根据符号位补 `0`（无符号补 `0`，有符号补符号位），相当于除以 `2^n` | `a >> 1 = 2 (0010)` |

---

### **位运算的常见应用**

位运算因其高效性，广泛用于算法中，尤其是在处理集合、数学问题、状态压缩等场景。以下是一些典型应用：

---

#### **1. 判断奇偶性**

**场景**：

- 判断一个整数是奇数还是偶数。

**思路**：

- 奇数的最低位总是 `1`，偶数的最低位总是 `0`。
- 使用按位与操作：`num & 1`。

**代码**：

```python
def is_odd(num):
    return num & 1 == 1

```

**示例**：

- `5 & 1 = 1`（奇数）。
- `4 & 1 = 0`（偶数）。

---

#### **2. 交换两个变量的值（不使用临时变量）**

**场景**：

- 用位运算交换两个数的值。

**思路**：

- 使用按位异或操作：`x = x ^ y`。
- 性质：`x ^ x = 0`，`x ^ 0 = x`。

**代码**：

```python
def swap(a, b):
    a = a ^ b
    b = a ^ b
    a = a ^ b
    return a, b

```

**示例**：

- `a = 5, b = 3` -> 交换后 `a = 3, b = 5`。

---

#### **3. 找到数组中唯一的元素（其他元素都出现两次）**

**场景**：

- 一个数组中，除了一个数字出现一次，其他数字都出现两次，找出这个唯一的数字。

**思路**：

- 利用异或操作的性质：`x ^ x = 0`，`x ^ 0 = x`。
- 将数组中所有数字异或，最终结果就是那个唯一的数字。

**代码**：

```python
def single_number(nums):
    result = 0
    for num in nums:
        result ^= num
    return result

```

**示例**：

- 输入：`nums = [2, 2, 1]`。
- 输出：`1`。

---

#### **4. 检测数字的某一位是否为 1**

**场景**：

- 检查整数 `n` 的第 `k` 位是否为 `1`。

**思路**：

- 使用按位与操作：`(n >> k) & 1`。

**代码**：

```python
def is_kth_bit_set(n, k):
    return (n >> k) & 1 == 1

```

**示例**：

- `n = 5 (0101)`，检查第 2 位（从 0 开始）是否为 `1`。
- 输出：`True`。

---

#### **5. 统计二进制中 1 的个数（汉明重量）**

**场景**：

- 统计一个整数的二进制表示中有多少个 `1`。

**思路**：

- 不断将 `n & (n-1)`，消去最低位的 `1`，直到 `n == 0`。

**代码**：

```python
def count_ones(n):
    count = 0
    while n:
        n &= (n - 1)
        count += 1
    return count

```

**示例**：

- `n = 9 (1001)`。
- 输出：`2`。

---

#### **6. 快速计算 2 的幂次倍数**

**场景**：

- 计算 `2^k`。

**思路**：

- 使用左移操作：`1 << k`。

**代码**：

```python
def power_of_two(k):
    return 1 << k

```

**示例**：

- `k = 3`。
- 输出：`8`。

---

#### **7. 判断一个数是否为 2 的幂**

**场景**：

- 判断 `n` 是否是 `2^k` 的形式。

**思路**：

- 2 的幂在二进制表示中只有一个 `1`。
- 检查 `n & (n - 1) == 0`。

**代码**：

```python
def is_power_of_two(n):
    return n > 0 and (n & (n - 1)) == 0

```

**示例**：

- 输入：`n = 8`。
- 输出：`True`。

---

#### **8. 位掩码（Bit Mask）**

**场景**：

- 用于状态压缩或集合表示。

**思路**：

- 使用一个整数的二进制位表示集合元素是否存在。
- 例如，`1011` 表示集合 `{0, 1, 3}`。

**操作**：

- 添加元素：`mask |= (1 << x)`。
- 删除元素：`mask &= ~(1 << x)`。
- 检查元素是否存在：`mask & (1 << x)`。

---

## **总结**

| 应用场景 | 使用的位运算 | 示例代码/说明 |
| --- | --- | --- |
| 判断奇偶性 | `num & 1` | `num & 1 == 1` 表示奇数 |
| 交换两个数 | `a ^ b` | 无需额外变量 |
| 找出唯一的元素 | `a ^ b` | 所有数异或结果即为唯一数 |
| 检测某一位是否为 1 | `n >> k` | `(n >> k) & 1 == 1` |
| 统计二进制中 1 的个数（汉明重量） | `n & (n-1)` | 不断消除最低位的 1 |
| 判断是否为 2 的幂 | `n & (n-1)` | `n > 0 and (n & (n-1)) == 0` |
| 位掩码（集合表示） | ` | `和`&` |

位运算是一种高效、简洁的操作，常用于优化算法，尤其是状态压缩、数学计算和集合操作中。如果你想深入了解某个具体应用，可以随时告诉我！😊
